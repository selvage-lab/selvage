# Change Log

## [0.1.6] - 2025-08-15

### Added

#### feat: 멀티턴 리뷰 시스템 구현

**핵심 변경사항**

- **자동 컨텍스트 제한 처리**: LLM API의 컨텍스트 제한 초과 시 자동으로 프롬프트를 분할하여 순차 처리 후 결과를 지능적으로 합성하는 멀티턴 리뷰 시스템 구현
- **지능적 프롬프트 분할**: 토큰 정보와 텍스트 길이를 고려한 그리디 알고리즘 기반 최적 분할 (안전 여유분 20% 확보)
- **LLM 기반 결과 합성**: Summary는 LLM을 활용한 지능적 합성, 실패 시 fallback 로직 적용

**세부 구현사항**

- **MultiturnReviewExecutor**: 멀티턴 리뷰 프로세스의 메인 조정자 역할
- **PromptSplitter**: 토큰 비율 계산 및 텍스트 길이 기반 균등 분배 알고리즘
- **ReviewSynthesizer**: Issues 단순 합산, Summary LLM 합성, Recommendations 중복 제거를 통한 지능적 결과 합성
- **SynthesisAPIClient & SynthesisPromptManager**: 모든 LLM 프로바이더 지원하는 통합 API 호출 및 작업별 프롬프트 관리

**성능 최적화 및 안정성**

- **순차 처리 방식**: OpenRouter 동시성 문제 해결을 위한 병렬 처리에서 순차 처리로 전환
- **정확한 비용 계산**: 전체 청크 처리 비용과 합성 비용의 투명한 계산 및 표시
- **에러 패턴 개선**: Anthropic의 새로운 context limit 에러 패턴 추가, max_tokens 값 64000으로 증가

**문서화 및 개발 가이드**

- **상세 시스템 문서**: `.cursor/rules/multiturn-review-system.mdc` 추가로 컴포넌트 의존성, 워크플로우, 분할 전략 등 포괄적 문서화
- **아키텍처 통합**: 기존 워크플로우 문서에 멀티턴 처리 단계 통합하여 전체 시스템 이해도 향상

## [0.1.5] - 2025-08-06

### Added

#### feat: 코드 리뷰 시스템 개선 및 성능 최적화

**핵심 변경사항**

- **라인 번호 계산 최적화**: target_code의 line_number 계산 책임을 LLM에서 Python 코드로 이전하여 정확도 향상
- **시스템 프롬프트 v4 도입**: 요약 필드 지침 강화 및 코드 품질 평가 기준 개선
- **파일 읽기 성능 최적화**: 캐시 시스템 구현으로 동일 파일 반복 접근 시 성능 대폭 개선

**세부 개선사항**

- **FormattedHunk 클래스 최적화**: 불필요한 속성 제거로 메모리 사용량 감소
- **테스트 강화**: 라인 번호 계산기에 대한 325개 라인의 포괄적 테스트 케이스 추가
- **API 키 오류 처리 개선**: 다양한 오류 시나리오 검증 및 segfault 방지 로직 추가

## [0.1.4] - 2025-08-03

### Added

#### feat: context extract 기능 구현

**핵심 기능**

##### 컨텍스트 추출 개선

- **Tree-sitter 기반 smart context extractor 도입**: AST 분석을 통해 변경 라인이 속하는 가장 작은 코드 블록과 파일에 존재하는 dependency statement (import, require, define 등)를 자동 추출
  - **다중 언어 지원**: Python, JavaScript/TypeScript, Java/Kotlin 언어에 대한 전문적인 컨텍스트 추출 지원
  - **Smart Context 적용 조건**: 전체 파일 대비 변경 라인이 20% 이하일 때 사용되며, 그 이상일 때는 전체 파일 컨텍스트 사용
- **Fallback 컨텍스트 추출기**: 지원하지 않는 언어(C, C#, Go, Swift 등)에 대해서는 정규표현식 기반 패턴 매칭으로 컨텍스트 추출

**추가 개선사항**

- **시스템 프롬프트 개선**: 시스템 프롬프트 업그레이드하여 더 정확한 컨텍스트 기반 코드 리뷰 제공
- **무의미한 변경 필터링**: 빈 라인, 주석, 전처리기 지시문 등 무의미한 변경사항을 자동으로 필터링하여 리뷰 품질 향상
